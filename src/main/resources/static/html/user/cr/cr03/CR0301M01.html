<!DOCTYPE html>
<html lang="ko">
<style>
    .EST, .file {
        background-color: white;
        visibility: hidden;
    }

    .grid-cell-blue {
        background: #dcf0f8;
    }

    .file, .EST {
        min-height: 800px;
        float: left;
    }
    ul.ul_list.type03-est li {
        width: calc(100% - 6px);
        float: left;
    }

    ul.ul_list.type03-est li:nth-child(odd) {
        clear: left;
    }

    ul.ul_list.type03-est li+li {
    }
    @media only screen and (max-width: 767px) {
        .file, .EST {
            width: 100%;
        }
    }

    @media only screen and (min-width: 768px) {
        .file, .EST {
            width: 50%;
        }

    }
</style>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" href="/static/favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="/static/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="/static/bootstrap/css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="/static/bootstrap/css/dashboard.css">
    <link rel="stylesheet" href="/static/bootstrap/css/bootstrap-datepicker.css">
    <link rel="stylesheet" href="/static/fontawesome/css/all.css">
    <link rel="stylesheet" href="/static/css/ax5/ax5grid.css"/>
    <link rel="stylesheet" href="/static/css/ax5/ax5mask.css"/>
    <link rel="stylesheet" href="/static/css/ax5/ax5modal.css"/>
    <link rel="stylesheet" href="/static/css/ax5/ax5toast.css"/>
    <link rel="stylesheet" href="/static/css/jstree/style.min.css"/>
    <link rel="stylesheet" href="/static/css/gnb.css"/>
    <link rel="stylesheet" href="/static/css/main.css"/>
    <!--	<link rel="stylesheet" href="/static/css/sub.css" />-->
    <link rel="stylesheet" href="/static/css/common.css"/>

    <link rel="stylesheet" href="/static/css/sub.css"/>

    <link rel="stylesheet" type="text/css" href="https://cdn.rawgit.com/ax5ui/ax5ui-calendar/master/dist/ax5calendar.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.rawgit.com/ax5ui/ax5ui-picker/master/dist/ax5picker.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.rawgit.com/ax5ui/ax5ui-select/master/dist/ax5select.css">
    <link rel="stylesheet" href="/static/css/ax5/ax5menu.css">

   <script src="/static/js/jquery-latest.min.js"></script>
   <script src="/static/js/jquery.serializeObject.js"></script>
    <script src="/static/bootstrap/js/bootstrap.min.js"></script>
     <script src="/static/bootstrap/js/bootstrap-datepicker.min.js"></script>
    <script src="/static/bootstrap/js/bootstrap-datepicker.ko.min.js"></script>
    <script src="/static/js/moment/moment-with-locales.js"></script>
    <!-- <script src="/static/js/ax5/ax5core.min.js"></script>-->
    <script src="/static/js/ax5/ax5calendar.min.js"></script> 
    <script type="text/javascript" src="https://cdn.rawgit.com/ax5ui/ax5ui-picker/master/dist/ax5picker.min.js"></script>
    <script type="text/javascript" src="https://cdn.rawgit.com/ax5ui/ax5ui-formatter/master/dist/ax5formatter.min.js"></script>
    <script type="text/javascript" src="https://cdn.rawgit.com/ax5ui/ax5ui-select/master/dist/ax5select.min.js"></script>
    <!-- <script src="/static/js/ax5/ax5grid.min.js"></script> -->
    <script src="/static/js/ax5/ax5mask.min.js"></script>
    <script src="/static/js/ax5/ax5modal.min.js"></script>
    <script src="/static/js/ax5/ax5toast.min.js"></script>
    <script src="/static/js/jstree/jstree.min.js"></script>
    <script src="/static/js/ax5/ax5menu.min.js"></script>
    <script type="text/javascript" src="https://cdn.rawgit.com/ax5ui/ax5core/master/dist/ax5core.min.js"></script>
	<script type="text/javascript" src="https://cdn.rawgit.com/ax5ui/ax5ui-grid/master/dist/ax5grid.min.js"></script>


    <script type="text/javascript" src="https://t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
    <script src="/static/js/global.js"></script>
    <script src="/static/js/fileTree.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.5.0/jszip.min.js"></script>
   
    <style>

    </style>

</head>

<body>
<div id="head_area"></div>
<div id="top_area"></div>

<div id="main_area">
    <!-- 페이지 상단 -->
    <div class="contents no_bg">
        <ul class="btn_ul">
            <li class="btn_r">
                <a onclick="initSearch();">
                    <button class="bg_gray">초기화</button>
                </a>
                <a onclick="gridView.setData(0);">
                    <button class="bg_gray">검 색</button>
                </a>
            </li>
        </ul>
    </div>
    <!-- 검색 콘텐츠 -->
    <div class="contents search">
        <div class="">
            <!-- 테이블 인풋 3분할 -->
            <table class="table_input type04">
                <tr>
                    <th class="hit">회사</th>
                    <td>
                        <select id="coCd_S" style="width:100%;" data-kind="CO" onchange="gridView.setData(0);"
                                required="required">
                            <option value="">전체</option>
                        </select>
                    </td>
                    <th class="">Sales Code</th>
                    <td>
                        <input type="hidden" id="salesCd_S" name="salesCd_S">
                        <div class="search_form">
                            <input type="text" id="salesCdNm_S" name="salesCdNm_S">
                            <a onclick="opendSalesCdSearch($('#salesCdNm_S').val());">
                                <i class="i_search_w"></i>
                            </a>
                        </div>
                    </td>
					<th class="">고객사</th>
                    <td>
                        <input type="hidden" id="ordrsClntCd_S" name="ordrsClntCd_S">
                        <div class="search_form">
                            <input type="text" id="ordrsClntNm_S" name="ordrsClntNm_S"
                                   >
                            <a onclick="opendClntSearch($('#ordrsClntNm_S').val());">
                                <i class="i_search_w"></i>
                            </a>
                        </div>
                    </td>
                    <th class="">고객사 PJT</th>
                    <td>
                        <div class="search_form">
                            <input type="text" id="clntPjt_S" name="clntPjt_S" class="modal-clntPjt_S">
                        </div>
                    </td>
                </tr>
                <tr>
                    <th class="">제품구분</th>
                    <td>
						<input type="hidden" id="prdtId_S" name="prdtId_S" data-search="prdtCd" >
				   		<div class="search_form">
				    	  <input type="text" id="prdtNm_S" name="prdtNm_S" data-search="prdtNm" onkeyup="event.keyCode == 8 ? prdtId_S.value = '' : event.keyCode == 13 ? gridView.setData(0) : ''">
					    	<a onclick="openPrdtSearch();"><i class="i_search_w"></i></a>
						</div>
					</td>
                    <th class="">아이템구분</th>
                    <td>
                        <select id="itemList_S" style="width:100%;" data-kind="ITEMLIST" onchange="gridView.setData(0);"
                                required="required">
                            <option value="">전체</option>
                        </select>
                    </td>
                    <th class="">설비명</th>
                    <td>
                        <div class="search_form">
                            <input type="text" id="eqpNm_S" name="eqpNm_S" class="modal-eqpNm_S">
                        </div>
                    </td>
                </tr>
                <tr>

                </tr>
            </table>
        </div>
    </div>
    <div class="contents no_bg">
        <!-- 콘텐츠 타이틀 -->
        <div class="contents_tit">
            <div>
                <div style="float:right">
                    <a class="btn btn-default btn-sm" onclick="excelDown();"><i class="fas fa-file-excel"></i>
                        엑셀다운로드</a>
                </div>
                <div class="add_btn_small pdl10" style="margin-right:8px;">
                    <a onclick="insertProjectModal('C')" style="height: 30px; line-height: 28px;" authchk>+</a>
                    <a onclick="deleteEst()" style="height: 30px; line-height: 28px;" authchk>-</a>
                </div>

            </div>
            <select class="prae_select" style="height:30px;" onchange="gridView.setData(0);" id="recordCnt">
                <option value="10">10</option>
                <option value="20" selected>20</option>
                <option value="50">50</option>
                <option value="100">100</option>
                <option value="9999999">전체</option>
            </select>
            <div class="add_btn_small pdr10">

            </div>
            <input type="hidden" id="recordCnt">
            <input type="hidden" id="basisPriceSeq">
        </div>
    </div>
    <div class="contents">
        <div class="ax5_grid">
            <ul class="ul_list type03-est">
                <li>
                	<div class="table_list_tit">
                	</div>
                    <div>
                   		<div data-ax5grid="test-grid" data-ax5grid-config="{}" style="height: 250px; width: 100%;"></div>
                   	</div>
                </li>
                <li>
                    <div class="table_list_tit">
                    </div>
                    <div>
						<div data-ax5grid="initial-grid" data-ax5grid-config="{showRowSelector: true,
		                    multipleSelect: true,
		                    lineNumberColumnWidth: 40,
		                    rowSelectorColumnWidth: 27,}" style="height: 300px;width: 100%;"></div>
		                <!-- <div data-ax5grid="est-grid" data-ax5grid-config="{}" style="height: 250px; width: 100%;"></div> -->
                    </div>
                </li>
            </ul>
        </div>
    </div>
    <div class="contents_tit">
        <div>
           <div style="float:right">
               <a class="btn btn-default btn-sm" onclick="insertMaterialEditModal('C')">
                  	 자재정보수정</a>
           </div>
        </div>
    </div>
    
</div>

</body>

<script type="text/javascript">
    var authId = null;
    var authRole = null;
    var actionType = null;

    var originalData = [
        // 데이터를 여기에 넣습니다.
    ];

    var gridView = {
        initView: function () {
            this.target = new ax5.ui.grid();
            this.target.setConfig({
                height: "250px",
               
                showRowSelector: true,
                multipleSelect: false,
                sortable: true,
                target: $('[data-ax5grid="test-grid"]'),
                header: {
                    align: "center",
                    selector: false
                },
                body: {
                	onDBLClick: function () {
                        this.self.select(this.dindex);
                        var item = this.item; // 선택된 행의 데이터
                        var coCd = item.coCd; // 선택된 행의 coCd 값
                        handleDBlCLickEvent(this.item);
                        $(".EST ,.file").css("visibility", "visible");

                    },
                    onClick: function () {
                    	this.self.select(this.dindex);
                        var item = this.item; // 선택된 행의 데이터
                        var coCd = item.coCd; // 선택된 행의 coCd 값
                    	handleClickMainEvent(this.item);
                    	$(".EST ,.file").css("visibility", "visible"); 
                    },
                },
                page: {
                    navigationItemCount: 9,
                    height: 30,
                    display: true,
                    firstIcon: '<i class="fa fa-step-backward" aria-hidden="true"></i>',
                    prevIcon: '<i class="fa fa-caret-left" aria-hidden="true"></i>',
                    nextIcon: '<i class="fa fa-caret-right" aria-hidden="true"></i>',
                    lastIcon: '<i class="fa fa-step-forward" aria-hidden="true"></i>',
                    onChange: function () {
                        gridView.setData(this.page.selectPage);
                    }
                },
                columns: [             
                	{key: "salesCd", label: "Sales Code", align: "center", width: 100,},
                    {key: "salesCd", label: "ASSY", align: "center", width: 100},//?
                    {key: "unitNo", label: "UNIT", align: "center", width: 80},//?
                    {key: "partNo", label: "Part", align: "center", width: 80},
                    {key: "revNo", label: "Rev", align: "center", width: 80},
                    {key: "revNo", label: "품번", align: "center", width: 80},//?matrCd 자재코드
                    {key: "revNo", label: "품명", align: "center", width: 80},//?matrNm 자재명
                    {key: "matrMat", label: "소재", align: "center", width: 80},//MATR_MAT 소재
                    {key: "matrMakrNm", label: "MAKER", align: "center", width: 80},//MATR_MAKR_NM 제조사
                    {key: "matrMno", label: "형번", align: "center", width: 80},
                    {key: "matrSpec", label: "규격", align: "center", width: 80},
                    {key: "matrSaftQty", label: "수량", align: "center", width: 80},//MATR_SAFT_QTY 임시 안전재고 
                    /* {key: "matrSpec", label: "기능버튼", align: "center", width: 80}, */// 임시 생략
                ],
            });
            return this;
        },
        setData: function (_pageNo) {
            var gridViewIn = this.target;
            if (inputValidation($('input[required]'))) {
                var formData = {
                    "coCd": $('#coCd_S').val(),
                    "salesCd": $("#salesCd_S").val().replace(/\-/g, ''),
                    "ordrsClntCd": $("#ordrsClntCd_S").val().replace(/\-/g, ''),
                    "clntPjt": $("#clntPjt_S").val(),
                    "prdtId": $("#prdtId_S").val(),//제품구분
                    "itemList": $("#itemList_S").val(),//아이템구분
                    "eqpNm": $("#eqpNm_S").val(),//설비명설비명

                }
                postAjax("/user/cr/cr03/selectEstList", formData, null, function (data) {
                    var list = data.estList;

                    // 원래 배열에서의 인덱스를 추적하는 새로운 필드 추가
                    for (let i = 0; i < list.length; i++) {
                        list[i].originalIndex = i;
                    }

                    // "estNo"와 원래 인덱스를 기준으로 정렬하기
                    /* list.sort(function (a, b) {
                        var numA = parseInt(a.estNo.replace(/\D/g, ''));
                        var numB = parseInt(b.estNo.replace(/\D/g, ''));
                        if (numA != numB) {
                            return numA - numB;
                        } else {
                            return a.originalIndex - b.originalIndex;
                        }
                    }); */
                    console.log(list)
                    originalData = list;
                    if (list.length === 0) {
                        gridViewIn.setData({
                            list: [],
                            page: {
                                currentPage: _pageNo,
                                pageSize: data.paginationInfo.pageSize,
                                totalElements: list.length,
                                totalPages: data.paginationInfo.totalPageCount
                            }
                        });
                    } else {
                    	gridViewIn.setData({
                            list: list,
                            page: {
                                currentPage: _pageNo,
                                pageSize: data.paginationInfo.pageSize,
                                totalElements: list.length,
                                totalPages: data.paginationInfo.totalPageCount
                            }
                        });
                    }
                });
            }
        }
    }
    
    function fetchCurrencyData() {
        var paramObj = {"codeKind": "UNITDIV", "useYn": "Y"};
        var paramObj2 = {"codeKind": "ESTDIV", "useYn": "Y"};

        var promise1 = new Promise(function (resolve, reject) {
            postAjax("/admin/cm/cm05/selectCodeList", paramObj, null, function (data) {
                if (data && data.codeList) {
                    var codeList = data.codeList;
                    var options = codeList.map(function (code) {
                        return {
                            value: code.codeNm,
                            text: code.codeNm
                        };
                    });
                    resolve(options);
                } else {
                    console.error("codeList is undefined. Check the AJAX response:", data);
                    reject(data);
                }
            });
        });

        var promise2 = new Promise(function (resolve, reject) {
            postAjax("/admin/cm/cm05/selectCodeList", paramObj2, null, function (data) {
                if (data && data.codeList) {
                    var codeList = data.codeList;
                    var options2 = codeList.map(function (code) {
                        return {
                            value: code.codeNm,
                            text: code.codeNm
                        };
                    });
                    resolve(options2);
                } else {
                    console.error("codeList is undefined. Check the AJAX response:", data);
                    reject(data);
                }
            });
        });

        return Promise.all([promise1, promise2]);
    }
    
    let selectedRowKey;
    let previousSelectedRowKey;
    let selectedPrdtCd;
    let selectedPrdtNm;
    const estGrid = new ax5.ui.grid();
    fetchCurrencyData().then(function ([options, options2]) {
        estGrid.setConfig({
            target: $('[data-ax5grid="est-grid"]'),
            header: {
                align: "center",
                selector: false
            },
            columns: [
                {
                    key: "estSeq", label: "번호", width: 40, align: "center", formatter: function () {
                        return this.item.__index + 1;
                    },
                },

                {
                    key: "estDtlDiv", label: "Sales Code", width: 100, align: "center", editor: {
                        type: "select",
                        config: {
                            columnKeys: {
                                optionValue: 'value',
                                optionText: 'text'
                            },
                            options: options2,


                        }
                    }
                },
                {
                    key: "estComm", label: "Part", align: "left", width: 100, editor: {
                        type: "text"


                    }
                },
                {key: "estSpec", label: "Unit", align: "left", width: 100, editor: {type: "text"}},
                {
                    key: "estUnit", label: "Rev", align: "center", width: 100, editor: {
                        type: "select",
                        config: {
                            columnKeys: {
                                optionValue: 'value',
                                optionText: 'text'
                            },
                            options: options // 서버에서 가져온 데이터를 사용
                        },
                        event: {
                            'blur': function () {
                                // logic to select the next input field and focus it
                            },
                            'keydown': function (e) {
                                if (e.keyCode == 9) { // tab key
                                    // logic to select the next input field and focus it
                                }
                            }
                        }
                    }
                },


                {key: "estQty", label: "도번", align: "right", width: 100, editor: {type: "number"}, formatter: "money"},
                {key: "estUpr", label: "품번", align: "right", width: 100, editor: {type: "number"}, formatter: "money"},
                {
                    key: "estAmt", label: "품명", width: 100, align: "right", formatter: function () {
                        color = '#0000FF';
                        const sum = this.item.estQty * this.item.estUpr;
                        return '<div style="color: ' + color + '">' + sum.toLocaleString('en-US') + '</div>';

                    }
                },
                {key: "estRmk", label: "소재", align: "center", width: 80, editor: {type: "text"}},
                {key: "estRmk", label: "MAK ER", align: "center", width: 80, editor: {type: "text"}},
                {key: "estRmk", label: "형번", align: "center", width: 80, editor: {type: "text"}},
                {key: "estRmk", label: "규격", align: "center", width: 80, editor: {type: "text"}},
                {key: "estRmk", label: "용도", align: "center", width: 80, editor: {type: "text"}},
                {key: "estRmk", label: "유형", align: "center", width: 80, editor: {type: "text"}},
                {key: "estRmk", label: "후행업체", align: "center", width: 80, editor: {type: "text"}},
            ],

            footSum: [
                [
                    {label: "총합계", align: "center", colspan: 7},
                    {key: "estAmtAll", collector: "sum", formatter: "money", align: "right"},
                ]
            ],
            body: {
                grouping: {
                    by: ["estDtlDiv"],
                    columns: [
                        {label: "소계", colspan: 7, align: "center"},
                        {
                            key: "estAmtMid",
                            collector: function () {
                                let sum = 0;
                                this.list.forEach(function (n) {
                                    if (!n.__grouping) sum += n.estQty * n.estUpr;
                                });
                                return sum;
                                //중간소계
                            },
                            formatter: "money",
                            align: "right",
                        },
                    ],

                },
                onClick: function () {
                    this.self.clearSelect();
                    this.self.select(this.dindex);
                    const subtotalRowsBeforeIndex = countSubtotalRowsBeforeIndex(this, this.dindex);
                    const realIndex = this.dindex - subtotalRowsBeforeIndex;
                    selectedRowKey = realIndex;
                    if (this.column.key == 'estComm') {
                        var _this = this;

                        // 선택된 행의 "estDtlDiv"값을 가져옵니다.
                        let estDtlDivValue = estGrid.list[selectedRowKey].estDtlDiv;

                        // 만약 "estDtlDiv"값이 "제작품"이라면 openPrdtSearch 함수를 호출합니다.

                    }

                }
            },
            contextMenu: {
                iconWidth: 20,
                acceleratorWidth: 100,
                itemClickAndClose: false,
                icons: {
                    'arrow': '<i class="fa fa-caret-right"></i>'
                },
                items: [
                    {type: 1, label: "붙여넣기"},
                    {divide: true},
                    {
                        label: "작업선택",
                        items: [
                            {type: 1, label: "줄추가"},
                            {type: 1, label: "내용 삭제"},
                            {type: 2, label: "줄삭제"},
                        ]
                    },
                ],
                popupFilter: function (item, param) {
                    //console.log(item, param);
                    if (param.element) {
                        return true;
                    } else {
                        return item.type == 1;
                    }
                },

                onClick: function (item, param) {
                    console.log(item, param);
                    thisGridRow = param.dindex;
                    thisGridCol = param.colIndex;

                    if (item.label == "붙여넣기") {
                        gridPaste(thisGridRow, thisGridCol);
                    } else if (item.label == "줄추가") {
                        console.log('추가 인덱스 :', param.dindex);
                        //.addRow(추가할 내용, 삽인할위치(생략시 마지막),갯수)
                        estGrid.addRow($.extend({}, estGrid.list[param.dindex], {__index: undefined}), param.dindex + 1,);
                        estGrid.setValue(param.dindex, 'updcheck', 1);

                    } else if (item.label == "내용 삭제") {
                        console.log('내용삭제 인덱스 :', param.dindex);

                        estGrid.config.columns.forEach((column) => {
                            estGrid.setValue(param.dindex, column.key, '');
                            estGrid.setValue(param.dindex, 'updcheck', 1);
                            console.log('내용삭제 :', param.dindex, column.key);
                        });

                    } else if (item.label == "줄삭제") {
                        console.log('삭제 인덱스 :', param.dindex);
                        const subtotalRowsBeforeIndex = countSubtotalRowsBeforeIndex(estGrid, param.dindex);
                        const realIndex = param.dindex - subtotalRowsBeforeIndex;
                        estGrid.removeRow(realIndex);
                    }


                    estGrid.contextMenu.close();
                    //또는 return true;

                }
            }

        });


        estGrid.setColumnSort({
            "estSeq": {orderBy: "asc", seq: 0},
        });
        let isUpdating = false;  // isUpdating 플래그 선언
        estGrid.onDataChanged = function () {

            if (this.item.estDtlDiv == undefined || isUpdating) {
                return;
            } else {
                isUpdating = true;  // 업데이트 시작을 표시

                const data = estGrid.getList();
                data.forEach((item, index) => {
                    item.estAmtAll = item.estQty * item.estUpr;  // 합계 계산 및 설정
                });
                estGrid.setData({
                    list: data,
                    page: {
                        totalElements: data.length
                    }
                });
                isUpdating = false;  // 업데이트 종료를 표시
            }


        };
        let checkDataInterval = null;

        estGrid.onLoad = function () {
            checkDataInterval = setInterval(() => {
                const data = estGrid.getList();

                // 데이터가 로드되었는지 확인합니다.
                if (data.length > 0) {
                    clearInterval(checkDataInterval);  // 데이터가 로드되었다면 체크를 중단합니다.

                    data.forEach((item, index) => {
                        item.estAmtAll = item.estQty * item.estUpr;  // 합계 계산 및 설정
                    });


                    estGrid.setData({
                        list: data,
                        page: {
                            totalElements: data.length
                        }
                    });
                }
            }, 100);
        };
    })
    
    //화면로드시
    $(document).ready(function () {
        //excelView.initView();
        gridView.initView();
        //gridView.initView().setData(0);
        //$("#coCd_S").focus();
        mainDefaultLoad("영업관리", "구매 BOM 등록");
        setCommonSelect($("#main_area select[data-kind]"));
        //$("#coCd_S").val(jwt.coCd);
        //setByCoCd($("#coCd_S").val());
        
		
    })
    
    async function handleDBlCLickEvent(item) {
		var initalGrid = new ax5.ui.grid();
	        
        initalGrid.setConfig({
            target: $('[data-ax5grid="initial-grid"]'),
            body: {
                onClick: function () {
                	if(this.column.key == 'matrBtn'){
                		this.self.select(this.dindex);
                        var item = this.item; // 선택된 행의 데이터
                        handleClickMatBtn(this.item);
                	}
                },
            },
            columns: [
                /* {key: "a", label: "field A"},
                {key: "b", label: "field B"},
                {key: "c", label: "numbers C"},
                {key: "d", label: "field D"},
                {key: "e", label: "field E"},
                {key: "f", label: "field F"},
                {key: "g", label: "field G"},
                {key: "h", label: "field H"} */
                {key: "salesCd", label: "Sales Code", align: "center", width: 100,},
                {key: "salesCd", label: "ASSY", align: "center", width: 100},//?
                {key: "unitNo", label: "UNIT", align: "center", width: 80},//?
                {key: "partNo", label: "Part", align: "center", width: 80},
                {key: "revNo", label: "Rev", align: "center", width: 80},
                {key: "revNo", label: "품번", align: "center", width: 80},//?matrCd 자재코드
                {key: "revNo", label: "품명", align: "center", width: 80},//?matrNm 자재명
                {key: "matrMat", label: "소재", align: "center", width: 80},//MATR_MAT 소재
                {key: "matrMakrNm", label: "MAKER", align: "center", width: 80},//MATR_MAKR_NM 제조사
                {key: "matrMno", label: "형번", align: "center", width: 80},
                {key: "matrSpec", label: "규격", align: "center", width: 80},
                {key: "matrSaftQty", label: "수량", align: "center", width: 80},//MATR_SAFT_QTY 임시 안전재고 
                {key: "matrBtn", label: "기능버튼", align: "center", width: 80, formatter: function(){
                	if(this.item.matrSaftQty > 0){
	                    return "자재정보수정";
                	} else {
	                    return "";
                	}
                }}, // 임시 생략
            ]
        });
        
        var dataTest = [
        	{salesCd: "A", salesCd: "A01", unitNo:"C", partNo:"D", revNo:"E", revNo:"F", revNo:"G", matrMat:"G", matrMakrNm:"G", matrMno:"G", matrSpec:"G", matrSaftQty:1, matrBtn:""},
        	{salesCd: "A", salesCd: "A01", unitNo:"D", partNo:"D", revNo:"E", revNo:"F", revNo:"G", matrMat:"G", matrMakrNm:"G", matrMno:"G", matrSpec:"G", matrSaftQty:0, matrBtn:""}]
        initalGrid.setData(dataTest);
    }
    
    async function handleClickMainEvent(item) {
    	console.log("handleClickMainEvent")
    }
    async function handleClickMatBtn(item) {
    	if(item.matrSaftQty > 0){
    		alert("자재정보수정 클릭")
    	}
    }
    
    async function updateDetailGrid(item) {
    	console.log("updateDetailGrid")
    }
    
    function insertProjectModal(type) {
        var paramObj = {"actionType": type};
        openModal("/static/html/user/cr/cr03/CR0302P01.html", 1400, 736, "", paramObj);
        treeModule.initFileArrays();
    }
    
    function initSearch() {
    	$(".table_input.type04 input[type='text']").val("");
    	
    	// 회사 선택 상자 값 설정
        //$("#coCd_S").val(jwt.coCd);
        // 그리드 뷰 초기화
        gridView.initView()
    }
    
    function loadEstDegrees() {
         var maxEstDeg = 1; // maxEstDeg를 숫자로 변환
         var selectElem = document.getElementById("estDeg_S");
         selectElem.innerHTML = ""; // 기존 옵션 초기화

         // '전체' 옵션을 생성하고 추가
         var allOptionElem = document.createElement("option");
         allOptionElem.value = "";
         allOptionElem.text = "전체";
         selectElem.add(allOptionElem);

         for (var i = 1; i <= maxEstDeg; i++) {
             var optionElem = document.createElement("option");
             optionElem.value = i;
             optionElem.text = i;
             selectElem.add(optionElem);
         }
         console.log('Updated select element:', selectElem); // 업데이트된 selectElem 로깅
    }
           
</script>
</html>